<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8">
<title>Outfit Spinner</title>
<style>
body {
    font-family: Arial, sans-serif;
    background: #f2f2f2;
    margin: 0;
    text-align: center;
}

button, select {
    padding: 10px 15px;
    font-size: 16px;
    margin: 5px;
}

#app {
    display: none;
    padding: 20px;
}

#camera {
    width: 90%;
    max-width: 400px;
    border-radius: 10px;
}

#outfit {
    margin-top: 20px;
}

.outfit-img {
    width: 150px;
    margin: 5px;
    border-radius: 10px;
}

.hidden {
    display: none;
}
</style>
</head>
<body>

<h1>ðŸ‘• Outfit Spinner</h1>

<button id="startBtn">Start</button>

<div id="app">
    <h2>Legg til klÃ¦r</h2>

    <select id="category">
        <option value="genser">Genser</option>
        <option value="tshirt">T-skjorte</option>
        <option value="bukse">Bukse</option>
        <option value="sko">Sko</option>
    </select>

    <br><br>

    <video id="camera" autoplay></video><br>
    <button id="takePhoto">Ta bilde</button>

    <hr>

    <h2>ðŸŽ° Outfit</h2>
    <button id="spin">Spin</button>

    <div id="outfit"></div>
</div>

<script>
const startBtn = document.getElementById("startBtn");
const app = document.getElementById("app");
const camera = document.getElementById("camera");
const takePhotoBtn = document.getElementById("takePhoto");
const categorySelect = document.getElementById("category");
const outfitDiv = document.getElementById("outfit");
const spinBtn = document.getElementById("spin");

const clothes = JSON.parse(localStorage.getItem("clothes")) || {
    genser: [],
    tshirt: [],
    bukse: [],
    sko: []
};

startBtn.onclick = async () => {
    startBtn.style.display = "none";
    app.style.display = "block";

    const stream = await navigator.mediaDevices.getUserMedia({ video: true });
    camera.srcObject = stream;
};

takePhotoBtn.onclick = () => {
    const canvas = document.createElement("canvas");
    canvas.width = camera.videoWidth;
    canvas.height = camera.videoHeight;
    const ctx = canvas.getContext("2d");
    ctx.drawImage(camera, 0, 0);

    const imgData = canvas.toDataURL("image/png");
    const category = categorySelect.value;

    clothes[category].push(imgData);
    localStorage.setItem("clothes", JSON.stringify(clothes));

    alert(category + " lagret!");
};

spinBtn.onclick = () => {
    outfitDiv.innerHTML = "";

    const order = ["genser", "tshirt", "bukse", "sko"];

    order.forEach(type => {
        if (clothes[type].length > 0) {
            const img = document.createElement("img");
            img.className = "outfit-img";
            img.src = clothes[type][Math.floor(Math.random() * clothes[type].length)];
            outfitDiv.appendChild(img);
        }
    });
};
</script>

</body>
</html>
